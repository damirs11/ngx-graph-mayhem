<table #table>
  <tbody>
  <tr>
    <td>
      <div class="content">
        <span>key</span>
        <span>value</span>
      </div>
    </td>
    <td>
      <div class="content">
        <span>key</span>
        <span>value</span>
      </div>
    </td>
  </tr>
  <tr>
    <td>
      <div class="content">
        <span>key</span>
        <span>value</span>
      </div>
    </td>
    <td>
      <div class="content">
        <span>key</span>
        <span>value</span>
      </div>
    </td>
  </tr>
  </tbody>
</table>
<button (click)="switch()">switch</button>

<div>
  <span>{{getNodes() | json}}</span>
</div>

<ngx-graph
  #graph
  *ngIf="_switch"
  [showMiniMap]="true"
  [draggingEnabled]="true"
  [enableZoom]="true"


  [links]="links"
  [nodes]="nodes"
  [layout]="layout"
  [layoutSettings]="settings"
>

  <ng-template #defsTemplate>
    <svg:marker id="arrow-R" viewBox="0 -5 10 10" refX="8" refY="0" markerWidth="4" markerHeight="4" orient="auto">
      <svg:path d="M0,-5L10,0L0,5" class="arrow-head"/>
    </svg:marker>
    <svg:marker id="arrow-L" viewBox="-10 -5 10 10" refX="-8" refY="0" markerWidth="4" markerHeight="4" orient="auto">
      <svg:path d="M0,-5L-10,0L0,5" class="arrow-head"/>
    </svg:marker>
  </ng-template>

  <ng-template #nodeTemplate let-node>
    <svg:g class="node">
      <svg:foreignObject width="200" height="125" *ngIf="!node.data.middleware">
        <table style="height: 100%; width: 100%;">
          <tbody>
          <tr>
            <td colspan="2">
              <div class="content center">
                <span>{{node.id}}</span>
              </div>
            </td>
          </tr>
          <tr>
            <td style="width: 50%;">
              <span>Прием</span>
            </td>
            <td style="width: 50%;" >
            </td>
          </tr>
          <tr>
            <td>
              <span>Сдача</span>
            </td>
            <td>
            </td>
          </tr>
          <tr>
            <td colspan="2">
              <div class="content">
                <span>Delta</span>
              </div>
            </td>
          </tr>
          </tbody>
        </table>
      </svg:foreignObject>

      <svg:foreignObject [attr.height]="28*2 + node.data.connections.length*20 " width="350" *ngIf="node.data.middleware">
        <table style="height: 100%; width: 100%;">
          <tbody>
          <tr>
            <td style="width: 40%;">
              <div class="content center">
                <span>{{node.id}}</span>
              </div>
            </td>
            <td style="width: 30%;">
              <div class="content">
                <span>Прием</span>
              </div>
            </td>
            <td style="width: 30%;">
              <div class="content">
                <span>Сдача</span>
              </div>
            </td>
          </tr>
          <tr *ngFor="let connection of node.data.connections">
            <td>
              <span>{{connection}}</span>
            </td>
            <td>
            </td>
            <td>
            </td>
          </tr>
          <tr>
            <td>
              <span>ИТОГО</span>
            </td>
            <td>
            </td>
            <td>
            </td>
          </tr>
<!--          <tr style="height: 20%">-->
<!--            <td colspan="2">-->
<!--              <div class="content">-->
<!--                <span>Delta</span>-->
<!--              </div>-->
<!--            </td>-->
<!--          </tr>-->
          </tbody>
        </table>
      </svg:foreignObject>
    </svg:g>
  </ng-template>
</ngx-graph>
